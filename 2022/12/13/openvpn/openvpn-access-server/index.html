<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>安装&amp;破解Openvpn Access Server</title><meta name="description" content="混迹在IT行业的小菜鸟"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="在线安装（需要翻墙）yum -y install https://as-repository.openvpn.net/as-repo-centos7.rpm
yum -y install openvpn-as

管理员登录首先需要修改管理员密码
passwd openvpn

输入之后可以登录管理员页面了。
如果密码一直错误的话，说明修改失败了，可以查看下原来的密码是什么
cat /usr/local/openvpn_as/init.log

登录后点击User Management–&amp;gt;User Permissions 添加用户
破解用户数
主要操作的文件是一个名叫 pyovpn-2.0-pyx.x.egg 的文件，以我了解的情况来看，从 2.5.0 到 2.9.x 文件名一直都是这个，只是不同版本里.."><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="YanTao的线上笔记本" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Almighty.Yantao's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">安装&amp;破解Openvpn Access Server</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%EF%BC%88%E9%9C%80%E8%A6%81%E7%BF%BB%E5%A2%99%EF%BC%89"><span class="toc-text">在线安装（需要翻墙）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95"><span class="toc-text">管理员登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E7%94%A8%E6%88%B7%E6%95%B0"><span class="toc-text">破解用户数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-text">方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E6%9C%89%E7%9A%84%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4"><span class="toc-text">所有的操作命令</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/2.9.0"><i class="tag post-item-tag">2.9.0</i></a><a href="/tags/openvpn"><i class="tag post-item-tag">openvpn</i></a><a href="/tags/openvpn%20access%20server"><i class="tag post-item-tag">openvpn access server</i></a><a href="/tags/%E7%A0%B4%E8%A7%A3"><i class="tag post-item-tag">破解</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">安装&amp;破解Openvpn Access Server</h1><time class="has-text-grey" datetime="2022-12-13T07:02:54.232Z">2022-12-13</time><article class="mt-2 post-content"><h2 id="在线安装（需要翻墙）"><a href="#在线安装（需要翻墙）" class="headerlink" title="在线安装（需要翻墙）"></a>在线安装（需要翻墙）</h2><pre><code class="shell">yum -y install https://as-repository.openvpn.net/as-repo-centos7.rpm
yum -y install openvpn-as
</code></pre>
<h2 id="管理员登录"><a href="#管理员登录" class="headerlink" title="管理员登录"></a>管理员登录</h2><p>首先需要修改管理员密码</p>
<pre><code class="shell">passwd openvpn
</code></pre>
<p>输入之后可以登录管理员页面了。</p>
<p>如果密码一直错误的话，说明修改失败了，可以查看下原来的密码是什么</p>
<pre><code class="shell">cat /usr/local/openvpn_as/init.log
</code></pre>
<p>登录后点击User Management–&gt;User Permissions 添加用户</p>
<h2 id="破解用户数"><a href="#破解用户数" class="headerlink" title="破解用户数"></a>破解用户数</h2><ul>
<li>主要操作的文件是一个名叫 <code>pyovpn-2.0-pyx.x.egg</code> 的文件，以我了解的情况来看，从 <code>2.5.0</code> 到 <code>2.9.x</code> 文件名一直都是这个，只是不同版本里面的内容不一样.</li>
<li>这个文件有点类似 <code>Java</code> 当中的 <code>jar</code> 库文件，也是一个 <code>zip</code> 压缩文件，里面包含了一些 <code>Python</code> 的字节码文件.</li>
<li>破解的原理大概是在 <code>Python</code> 中采用类似 <code>Java</code> 动态代理的技术，将原本读取用户属性的调用返回值拦截，修改用户限制数量再返回.</li>
</ul>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p><code>2.9.0</code> 以下版本破解的目标文件是 <code>/pyovpn/lic/uprop.pyo</code>, <code>2.9.0</code> 及以上是 <code>/pyovpn/lic/uprop.pyc</code>; 按照网上流行的破解方法，把这个文件解压出来并改名为 <code>uprop2.pyo</code> 或 <code>uprop2.pyc</code>, 然后新建一个 <code>uprop.py</code> 文件，内容如下:</p>
<p><code>**2.9.0**</code><strong>以下版本内容:</strong></p>
<pre><code class="shell">import uprop2
old_figure = None

def new_figure(self, licdict):
    ret = old_figure(self, licdict)
    ret[&#39;concurrent_connections&#39;] = 1024
    return ret


for x in dir(uprop2):
    if x[:2] == &#39;__&#39;:
        continue
    if x == &#39;UsageProperties&#39;:
        exec(&#39;old_figure = uprop2.UsageProperties.figure&#39;)
        exec(&#39;uprop2.UsageProperties.figure = new_figure&#39;)
    exec(&#39;%s = uprop2.%s&#39; % (x, x))
</code></pre>
<p><code>**2.9.0**</code><strong>及以上版本内容:</strong></p>
<pre><code class="shell">from pyovpn.lic import uprop2
old_figure = None

def new_figure(self, licdict):
    ret = old_figure(self, licdict)
    ret[&#39;concurrent_connections&#39;] = 1024
    return ret


for x in dir(uprop2):
    if x[:2] == &#39;__&#39;:
        continue
    if x == &#39;UsageProperties&#39;:
        exec(&#39;old_figure = uprop2.UsageProperties.figure&#39;)
        exec(&#39;uprop2.UsageProperties.figure = new_figure&#39;)
    exec(&#39;%s = uprop2.%s&#39; % (x, x))
</code></pre>
<p>再将上面的 <code>uprop.py</code> 编译为库文件 <code>uprop.pyo</code> 或 <code>uprop.pyc</code>:</p>
<pre><code class="shell"># &lt;2.9.0
python2 -O -m compileall uprop.py
# &gt;=2.9.0
python3 -O -m compileall uprop.py &amp;&amp; mv __pycache__/uprop.cpython-37.opt-1.pyc uprop.pyc
</code></pre>
<blockquote>
<p>注意 <code>uprop.cpython-37.opt-1.pyc</code> 文件名会随着 <code>python</code> 版本变化而变化.</p>
</blockquote>
<p>现在我们得到了一个改文件名的文件 <code>uprop2.pyo</code> 或 <code>uprop2.pyc</code>, 和一个编译出来的 <code>uprop.pyo</code> 或 <code>uprop.pyc</code>; 把这两个文件压缩到 <code>pyovpn-2.0-pyx.x.egg</code> 的 <code>/pyovpn/lic/</code> 目录下，然后去服务器替换目标文件，重启服务就 OK 了.</p>
<h2 id="所有的操作命令"><a href="#所有的操作命令" class="headerlink" title="所有的操作命令"></a>所有的操作命令</h2><pre><code class="shell"># 把操作的文件复制出来到另外的一个文件夹下面操作
cd /usr/local/openvpn_as/lib/python &amp; mkdir pojie &amp; cp python/pyovpn-2.0-py3.6.egg ./pojie &amp; cd pojie/
# 改一个文件名，防止后面打包的时候把源文件覆盖了
mv pyovpn-2.0-py3.6.egg pyovpn-2.0-py3.6.egg.bak &amp; unzip pyovpn-2.0-py3.6.egg.bak
# 进入到需要修改的目录
cd pyovpn/lic
# 复制源文件改名
mv uprop.pyc uprop2.pyc
# 新增一个py文件，然后把文件内容复制进去，并保存
vi uprop.py
# 退到 pojie 文件夹，进行打包
zip -r pyovpn-2.0-py3.6.egg EGG-INFO/ common/ pyovpn/
# 复制文件到运行目录，覆盖
cp pyovpn-2.0-py3.6.egg /usr/local/openvpn_as/lib/python
# 重启服务
systemctl restart openvpnas
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/12/13/zabbix/zabbix-wecom/" title="zabbix 警报推送至企业微信（图文版）"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: zabbix 警报推送至企业微信（图文版）</span></a><a class="button is-default" href="/2022/12/13/haproxy-load/" title="通过 Haproxy 实现 Shadowshadows 负载均衡"><span class="has-text-weight-semibold">下一页: 通过 Haproxy 实现 Shadowshadows 负载均衡</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/Claudia-theme-blog" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/almightyYantao"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> Almighty.Yantao 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>